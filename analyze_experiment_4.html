
<!DOCTYPE html>
<html>
<head>
<style type="text/css">
.knitr .inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage .left {
  text-align: left;
}
.rimage .right {
  text-align: right;
}
.rimage .center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
  <script src="https://yihui.name/media/js/center-images.js"></script>
  <title>A Report Generated by knitr</title>
</head>
<body>

  <p>This report is automatically generated with the R
    package <a href="https://yihui.name/knitr/"><strong>knitr</strong></a>
    (version <code class="knitr inline">1.20</code>)
    .</p>

<div class="chunk" id="auto-report"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(tidyverse)</span>
</pre></div>
<div class="message"><pre class="knitr r">## ── Attaching packages ───────────────────────────────────────────────── tidyverse 1.2.1 ──
</pre></div>
<div class="message"><pre class="knitr r">## ✔ ggplot2 3.0.0     ✔ purrr   0.2.5
## ✔ tibble  2.1.3     ✔ dplyr   0.8.3
## ✔ tidyr   0.8.1     ✔ stringr 1.3.1
## ✔ readr   1.1.1     ✔ forcats 0.3.0
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: package 'tibble' was built under R version 3.5.2
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: package 'dplyr' was built under R version 3.5.2
</pre></div>
<div class="message"><pre class="knitr r">## ── Conflicts ──────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(scales)</span>
</pre></div>
<div class="message"><pre class="knitr r">## 
## Attaching package: 'scales'
</pre></div>
<div class="message"><pre class="knitr r">## The following object is masked from 'package:purrr':
## 
##     discard
</pre></div>
<div class="message"><pre class="knitr r">## The following object is masked from 'package:readr':
## 
##     col_factor
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(broom)</span>
<span class="hl kwd">library</span><span class="hl std">(xtable)</span>
<span class="hl kwd">library</span><span class="hl std">(lsr)</span>
<span class="hl kwd">theme_set</span><span class="hl std">(</span><span class="hl kwd">theme_bw</span><span class="hl std">())</span>

<span class="hl kwd">source</span><span class="hl std">(</span><span class="hl str">'lib.R'</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## 
## Attaching package: 'ggridges'
</pre></div>
<div class="message"><pre class="knitr r">## The following object is masked from 'package:ggplot2':
## 
##     scale_discrete_manual
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwa">if</span> <span class="hl std">(</span><span class="hl opt">!</span><span class="hl kwd">dir.exists</span><span class="hl std">(</span><span class="hl str">'figures/exp4'</span><span class="hl std">))</span>
   <span class="hl kwd">dir.create</span><span class="hl std">(</span><span class="hl str">'figures/exp4'</span><span class="hl std">,</span> <span class="hl kwc">recursive</span> <span class="hl std">= T)</span>

<span class="hl std">apt_labels</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">data.frame</span><span class="hl std">(</span><span class="hl kwc">q_id</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">10</span><span class="hl std">,</span> <span class="hl num">11</span><span class="hl std">,</span> <span class="hl num">12</span><span class="hl std">),</span>
                         <span class="hl kwc">apt_label</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'Apartment 6: 1 bed, 3 bath, 726 sq ft'</span><span class="hl std">,</span>
                                       <span class="hl str">'Apartment 7: 1 bed, 1 bath, 788 sq ft'</span><span class="hl std">,</span>
                                       <span class="hl str">'Apartment 8: 1 bed, 3 bath, 350 sq ft'</span><span class="hl std">))</span>

<span class="hl std">my_pallete</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'#92c5de'</span><span class="hl std">,</span> <span class="hl str">'#f4a582'</span><span class="hl std">,</span> <span class="hl str">'#92c5de'</span><span class="hl std">,</span> <span class="hl str">'#f4a582'</span><span class="hl std">)</span>

<span class="hl com">#######################################################</span>
<span class="hl com"># Training phase</span>
<span class="hl com">#######################################################</span>
<span class="hl com"># read data from the training phase</span>
<span class="hl std">training_responses</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read_csv</span><span class="hl std">(</span><span class="hl str">&quot;data/exp4/data_training.csv&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Parsed with column specification:
## cols(
##   worker_id = col_character(),
##   condition = col_character(),
##   q_id = col_integer(),
##   q_index = col_integer(),
##   model_pred = col_double(),
##   actual_price = col_double(),
##   final_pred = col_double()
## )
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># recode conditions</span>
<span class="hl std">training_responses</span> <span class="hl kwb">&lt;-</span> <span class="hl std">training_responses</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">mutate</span><span class="hl std">(</span><span class="hl kwc">condition</span> <span class="hl std">=</span> <span class="hl kwd">recode_factor</span><span class="hl std">(</span><span class="hl kwd">as.factor</span><span class="hl std">(condition),</span>
                                   <span class="hl str">&quot;C0&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;BB-FOCUS&quot;</span><span class="hl std">,</span>
                                   <span class="hl str">&quot;C1&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;BB-NO-FOCUS&quot;</span><span class="hl std">,</span>
                                   <span class="hl str">&quot;C2&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;CLEAR-FOCUS&quot;</span><span class="hl std">,</span>
                                   <span class="hl str">&quot;C3&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;CLEAR-NO-FOCUS&quot;</span><span class="hl std">))</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">mutate</span><span class="hl std">(</span><span class="hl kwc">condition</span> <span class="hl std">=</span> <span class="hl kwd">factor</span><span class="hl std">(condition,</span> <span class="hl kwc">levels</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;CLEAR-NO-FOCUS&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;BB-NO-FOCUS&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;CLEAR-FOCUS&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;BB-FOCUS&quot;</span><span class="hl std">)))</span>

<span class="hl std">training_responses</span><span class="hl opt">$</span><span class="hl std">q_id</span> <span class="hl kwb">&lt;-</span> <span class="hl std">training_responses</span><span class="hl opt">$</span><span class="hl std">q_id</span> <span class="hl opt">+</span> <span class="hl num">1</span>

<span class="hl com"># plot histogram</span>
<span class="hl std">breaks</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">seq</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">3</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">)</span>
<span class="hl std">training_dist_plot</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ggplot</span><span class="hl std">(training_responses,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= final_pred,</span> <span class="hl kwc">fill</span><span class="hl std">=condition))</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_histogram</span><span class="hl std">(</span><span class="hl kwc">binwidth</span> <span class="hl std">=</span> <span class="hl num">0.1</span><span class="hl std">,</span> <span class="hl kwc">alpha</span> <span class="hl std">=</span> <span class="hl num">0.5</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_vline</span><span class="hl std">(</span><span class="hl kwc">alpha</span><span class="hl std">=</span><span class="hl num">.2</span><span class="hl std">,</span> <span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">xintercept</span> <span class="hl std">= model_pred,</span> <span class="hl kwc">linetype</span><span class="hl std">=</span><span class="hl str">&quot;Model's prediction&quot;</span><span class="hl std">))</span><span class="hl opt">+</span>
  <span class="hl kwd">geom_vline</span><span class="hl std">(</span><span class="hl kwc">alpha</span><span class="hl std">=</span><span class="hl num">.2</span><span class="hl std">,</span> <span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">xintercept</span> <span class="hl std">= actual_price,</span> <span class="hl kwc">linetype</span><span class="hl std">=</span><span class="hl str">&quot;Actual price&quot;</span><span class="hl std">))</span><span class="hl opt">+</span>
  <span class="hl kwd">scale_fill_manual</span><span class="hl std">(</span><span class="hl kwc">guide</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span><span class="hl kwc">values</span><span class="hl std">=my_pallete)</span> <span class="hl opt">+</span> <span class="hl kwd">scale_colour_manual</span><span class="hl std">(</span><span class="hl kwc">guide</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span> <span class="hl kwc">values</span><span class="hl std">=my_pallete)</span><span class="hl opt">+</span>
  <span class="hl kwd">facet_grid</span><span class="hl std">(</span><span class="hl kwd">vars</span><span class="hl std">(condition),</span> <span class="hl kwd">vars</span><span class="hl std">(q_id),</span> <span class="hl kwc">scale</span><span class="hl std">=</span><span class="hl str">'free'</span><span class="hl std">)</span><span class="hl opt">+</span>
  <span class="hl kwd">xlab</span><span class="hl std">(</span><span class="hl str">&quot;Participants' price prediction&quot;</span><span class="hl std">)</span><span class="hl opt">+</span>
  <span class="hl kwd">ylab</span><span class="hl std">(</span><span class="hl str">&quot;Number of participants&quot;</span><span class="hl std">)</span><span class="hl opt">+</span>
  <span class="hl kwd">scale_x_continuous</span><span class="hl std">(</span><span class="hl kwc">breaks</span> <span class="hl std">= breaks,</span> <span class="hl kwc">labels</span> <span class="hl std">=</span> <span class="hl kwd">sprintf</span><span class="hl std">(</span><span class="hl str">'$%dM'</span><span class="hl std">, breaks))</span> <span class="hl opt">+</span>
  <span class="hl kwd">theme</span><span class="hl std">(</span><span class="hl kwc">panel.grid.major</span> <span class="hl std">=</span> <span class="hl kwd">element_blank</span><span class="hl std">(),</span> <span class="hl kwc">panel.grid.minor</span> <span class="hl std">=</span> <span class="hl kwd">element_blank</span><span class="hl std">(),</span>
        <span class="hl kwc">legend.position</span><span class="hl std">=</span><span class="hl str">&quot;top&quot;</span><span class="hl std">,</span> <span class="hl kwc">legend.title</span> <span class="hl std">=</span> <span class="hl kwd">element_blank</span><span class="hl std">(),</span> <span class="hl kwc">legend.key</span> <span class="hl std">=</span> <span class="hl kwd">element_rect</span><span class="hl std">(</span><span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">10</span><span class="hl std">),</span> <span class="hl kwc">legend.key.size</span> <span class="hl std">=</span> <span class="hl kwd">unit</span><span class="hl std">(</span><span class="hl num">1.5</span><span class="hl std">,</span> <span class="hl str">'lines'</span><span class="hl std">),</span> <span class="hl kwc">legend.text</span><span class="hl std">=</span><span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">12</span><span class="hl std">),</span>
        <span class="hl kwc">axis.title.x</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">20</span><span class="hl std">),</span> <span class="hl kwc">axis.title.y</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">18</span><span class="hl std">),</span> <span class="hl kwc">axis.text.x</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">angle</span> <span class="hl std">=</span> <span class="hl num">45</span><span class="hl std">,</span> <span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">10</span><span class="hl std">),</span> <span class="hl kwc">axis.text.y</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">14</span><span class="hl std">),</span>
        <span class="hl kwc">strip.text</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">14</span><span class="hl std">))</span>
<span class="hl kwd">ggsave</span><span class="hl std">(training_dist_plot,</span> <span class="hl kwc">filename</span> <span class="hl std">=</span> <span class="hl str">&quot;figures/exp4/dist_training_final_prediction.pdf&quot;</span><span class="hl std">,</span> <span class="hl kwc">height</span><span class="hl std">=</span><span class="hl num">10</span><span class="hl std">,</span> <span class="hl kwc">width</span><span class="hl std">=</span><span class="hl num">10</span><span class="hl std">)</span>

<span class="hl com">#######################################################</span>
<span class="hl com"># Testing phase</span>
<span class="hl com">#######################################################</span>
<span class="hl com"># read testing phase data</span>
<span class="hl std">responses</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read_csv</span><span class="hl std">(</span><span class="hl str">&quot;data/exp4/data.csv&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Parsed with column specification:
## cols(
##   worker_id = col_character(),
##   condition = col_character(),
##   q_index = col_integer(),
##   q_id = col_integer(),
##   model_pred = col_double(),
##   actual_price = col_double(),
##   model_conf = col_integer(),
##   final_pred = col_double(),
##   user_final_price_conf = col_integer(),
##   step2_time = col_integer(),
##   step3_time = col_integer(),
##   hit_start_time = col_integer(),
##   hit_end_time = col_integer()
## )
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># recode conditions and compute outcome measures</span>
<span class="hl std">responses</span> <span class="hl kwb">&lt;-</span> <span class="hl std">responses</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">mutate</span><span class="hl std">(</span><span class="hl kwc">condition</span> <span class="hl std">=</span> <span class="hl kwd">recode_factor</span><span class="hl std">(</span><span class="hl kwd">as.factor</span><span class="hl std">(condition),</span>
                                   <span class="hl str">&quot;C0&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;BB-FOCUS&quot;</span><span class="hl std">,</span>
                                   <span class="hl str">&quot;C1&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;BB-NO-FOCUS&quot;</span><span class="hl std">,</span>
                                   <span class="hl str">&quot;C2&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;CLEAR-FOCUS&quot;</span><span class="hl std">,</span>
                                   <span class="hl str">&quot;C3&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;CLEAR-NO-FOCUS&quot;</span><span class="hl std">))</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">mutate</span><span class="hl std">(</span><span class="hl kwc">condition</span> <span class="hl std">=</span> <span class="hl kwd">factor</span><span class="hl std">(condition,</span> <span class="hl kwc">levels</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;CLEAR-NO-FOCUS&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;BB-NO-FOCUS&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;CLEAR-FOCUS&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;BB-FOCUS&quot;</span><span class="hl std">)))</span> <span class="hl opt">%&gt;%</span>

  <span class="hl kwd">mutate</span><span class="hl std">(</span><span class="hl kwc">pred_err</span> <span class="hl std">=</span> <span class="hl kwd">abs</span><span class="hl std">(final_pred</span> <span class="hl opt">-</span> <span class="hl std">actual_price),</span>
         <span class="hl kwc">trust</span> <span class="hl std">=</span> <span class="hl kwd">abs</span><span class="hl std">(final_pred</span> <span class="hl opt">-</span> <span class="hl std">model_pred),</span>
         <span class="hl kwc">signed_dev</span> <span class="hl std">= (final_pred</span> <span class="hl opt">-</span> <span class="hl std">model_pred))</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">mutate</span><span class="hl std">(</span><span class="hl kwc">transparency</span><span class="hl std">=</span><span class="hl kwd">ifelse</span><span class="hl std">(condition</span><span class="hl opt">==</span><span class="hl str">&quot;BB-FOCUS&quot;</span> <span class="hl opt">|</span> <span class="hl std">condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;BB-NO-FOCUS&quot;</span><span class="hl std">,</span><span class="hl str">&quot;BB&quot;</span><span class="hl std">,</span> <span class="hl str">'CLEAR'</span><span class="hl std">))</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">mutate</span><span class="hl std">(</span><span class="hl kwc">attention</span> <span class="hl std">=</span> <span class="hl kwd">ifelse</span><span class="hl std">(condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;BB-FOCUS&quot;</span> <span class="hl opt">|</span> <span class="hl std">condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;CLEAR-FOCUS&quot;</span><span class="hl std">,</span> <span class="hl str">'FOCUS'</span><span class="hl std">,</span> <span class="hl str">'NO-FOCUS'</span><span class="hl std">))</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">mutate</span><span class="hl std">(</span><span class="hl kwc">apt_label</span> <span class="hl std">=</span> <span class="hl kwd">ifelse</span><span class="hl std">(q_id</span> <span class="hl opt">==</span> <span class="hl num">10</span><span class="hl std">,</span> <span class="hl str">&quot;Apartment 6: 1 bed, 3 bath, 726 sq ft&quot;</span><span class="hl std">,</span>
                                  <span class="hl kwd">ifelse</span><span class="hl std">(q_id</span> <span class="hl opt">==</span> <span class="hl num">11</span><span class="hl std">,</span> <span class="hl str">'Apartment 7: 1 bed, 1 bath, 788 sq ft'</span><span class="hl std">,</span>
                                         <span class="hl kwd">ifelse</span><span class="hl std">(q_id</span> <span class="hl opt">==</span> <span class="hl num">12</span><span class="hl std">,</span> <span class="hl str">'Apartment 8: 1 bed, 3 bath, 350 sq ft'</span><span class="hl std">,</span> <span class="hl str">'NORMAL'</span><span class="hl std">))))</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">ungroup</span><span class="hl std">()</span>

<span class="hl com">#########################################</span>
<span class="hl com"># histograms</span>
<span class="hl com">#########################################</span>
<span class="hl com"># users' final prediction</span>
<span class="hl std">breaks</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">seq</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">3</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">)</span>
<span class="hl std">responses_w_NA</span> <span class="hl kwb">&lt;-</span> <span class="hl std">responses</span>

<span class="hl com"># recode apartment IDs</span>
<span class="hl std">responses_w_NA</span><span class="hl opt">$</span><span class="hl std">q_id</span> <span class="hl kwb">&lt;-</span> <span class="hl std">responses_w_NA</span><span class="hl opt">$</span><span class="hl std">q_id</span> <span class="hl opt">+</span> <span class="hl num">1</span>
<span class="hl std">responses_w_NA</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">within</span><span class="hl std">(responses_w_NA, q_id[q_id</span><span class="hl opt">==</span><span class="hl num">13</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl num">14</span><span class="hl std">)</span>
<span class="hl std">responses_w_NA</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">within</span><span class="hl std">(responses_w_NA, q_id[q_id</span><span class="hl opt">==</span><span class="hl num">12</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl num">13</span><span class="hl std">)</span>
<span class="hl std">responses_w_NA</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">within</span><span class="hl std">(responses_w_NA, q_id[q_id</span><span class="hl opt">==</span><span class="hl num">11</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl num">12</span><span class="hl std">)</span>


<span class="hl com"># replace -1 for actual price of synthetic apartments with NA</span>
<span class="hl std">responses_w_NA</span><span class="hl opt">$</span><span class="hl std">actual_price</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">replace</span><span class="hl std">(responses_w_NA</span><span class="hl opt">$</span><span class="hl std">actual_price,</span> <span class="hl kwd">which</span><span class="hl std">(responses_w_NA</span><span class="hl opt">$</span><span class="hl std">actual_price</span> <span class="hl opt">== -</span><span class="hl num">1</span><span class="hl std">),</span> <span class="hl num">NA</span><span class="hl std">)</span>

<span class="hl std">final_prediction_dist_plot</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ggplot</span><span class="hl std">(responses_w_NA,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= final_pred,</span> <span class="hl kwc">fill</span><span class="hl std">=condition))</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_histogram</span><span class="hl std">(</span><span class="hl kwc">binwidth</span> <span class="hl std">=</span> <span class="hl num">0.1</span><span class="hl std">,</span> <span class="hl kwc">alpha</span> <span class="hl std">=</span> <span class="hl num">0.5</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_vline</span><span class="hl std">(</span><span class="hl kwc">alpha</span><span class="hl std">=</span><span class="hl num">.2</span><span class="hl std">,</span> <span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">xintercept</span> <span class="hl std">= model_pred,</span> <span class="hl kwc">linetype</span><span class="hl std">=</span><span class="hl str">&quot;Model's prediction&quot;</span><span class="hl std">))</span><span class="hl opt">+</span>
  <span class="hl kwd">geom_vline</span><span class="hl std">(</span><span class="hl kwc">alpha</span><span class="hl std">=</span><span class="hl num">.2</span><span class="hl std">,</span> <span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">xintercept</span> <span class="hl std">= actual_price,</span> <span class="hl kwc">linetype</span><span class="hl std">=</span><span class="hl str">&quot;Actual price&quot;</span><span class="hl std">))</span><span class="hl opt">+</span>
  <span class="hl kwd">scale_fill_manual</span><span class="hl std">(</span><span class="hl kwc">guide</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span><span class="hl kwc">values</span><span class="hl std">=my_pallete)</span> <span class="hl opt">+</span> <span class="hl kwd">scale_colour_manual</span><span class="hl std">(</span><span class="hl kwc">guide</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span> <span class="hl kwc">values</span><span class="hl std">=my_pallete)</span><span class="hl opt">+</span>
  <span class="hl kwd">facet_grid</span><span class="hl std">(</span><span class="hl kwd">vars</span><span class="hl std">(condition),</span><span class="hl kwd">vars</span><span class="hl std">(q_id),</span> <span class="hl kwc">scale</span><span class="hl std">=</span><span class="hl str">'free'</span><span class="hl std">)</span><span class="hl opt">+</span>
  <span class="hl kwd">xlab</span><span class="hl std">(</span><span class="hl str">&quot;Participants' price prediction&quot;</span><span class="hl std">)</span><span class="hl opt">+</span>
  <span class="hl kwd">ylab</span><span class="hl std">(</span><span class="hl str">&quot;Number of participants&quot;</span><span class="hl std">)</span><span class="hl opt">+</span>
  <span class="hl kwd">scale_x_continuous</span><span class="hl std">(</span><span class="hl kwc">breaks</span> <span class="hl std">= breaks,</span> <span class="hl kwc">labels</span> <span class="hl std">=</span> <span class="hl kwd">sprintf</span><span class="hl std">(</span><span class="hl str">'$%dM'</span><span class="hl std">, breaks))</span> <span class="hl opt">+</span>
  <span class="hl kwd">theme</span><span class="hl std">(</span><span class="hl kwc">panel.grid.major</span> <span class="hl std">=</span> <span class="hl kwd">element_blank</span><span class="hl std">(),</span> <span class="hl kwc">panel.grid.minor</span> <span class="hl std">=</span> <span class="hl kwd">element_blank</span><span class="hl std">(),</span>
        <span class="hl kwc">legend.position</span><span class="hl std">=</span><span class="hl str">&quot;top&quot;</span><span class="hl std">,</span> <span class="hl kwc">legend.title</span> <span class="hl std">=</span> <span class="hl kwd">element_blank</span><span class="hl std">(),</span> <span class="hl kwc">legend.key</span> <span class="hl std">=</span> <span class="hl kwd">element_rect</span><span class="hl std">(</span><span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">10</span><span class="hl std">),</span> <span class="hl kwc">legend.key.size</span> <span class="hl std">=</span> <span class="hl kwd">unit</span><span class="hl std">(</span><span class="hl num">1.5</span><span class="hl std">,</span> <span class="hl str">'lines'</span><span class="hl std">),</span> <span class="hl kwc">legend.text</span><span class="hl std">=</span><span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">12</span><span class="hl std">),</span>
        <span class="hl kwc">axis.title.x</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">20</span><span class="hl std">),</span> <span class="hl kwc">axis.title.y</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">18</span><span class="hl std">),</span> <span class="hl kwc">axis.text.x</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">angle</span> <span class="hl std">=</span> <span class="hl num">45</span><span class="hl std">,</span> <span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">10</span><span class="hl std">),</span> <span class="hl kwc">axis.text.y</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">14</span><span class="hl std">),</span>
        <span class="hl kwc">strip.text</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">14</span><span class="hl std">))</span>
<span class="hl kwd">ggsave</span><span class="hl std">(final_prediction_dist_plot,</span> <span class="hl kwc">filename</span> <span class="hl std">=</span> <span class="hl str">&quot;figures/exp4/dist_final_prediction.pdf&quot;</span><span class="hl std">,</span> <span class="hl kwc">height</span><span class="hl std">=</span><span class="hl num">10</span><span class="hl std">,</span> <span class="hl kwc">width</span><span class="hl std">=</span><span class="hl num">10</span><span class="hl std">)</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: Removed 1600 rows containing missing values (geom_vline).
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">hist_responses</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">mutate</span><span class="hl std">(responses,</span> <span class="hl kwc">actual_price</span> <span class="hl std">=</span> <span class="hl kwd">ifelse</span><span class="hl std">(actual_price</span> <span class="hl opt">== -</span><span class="hl num">1</span><span class="hl std">,</span> <span class="hl num">NA</span><span class="hl std">, actual_price))</span>
<span class="hl std">hist_responses</span> <span class="hl kwb">&lt;-</span><span class="hl std">hist_responses</span> <span class="hl opt">%&gt;%</span> <span class="hl kwd">mutate</span><span class="hl std">(</span><span class="hl kwc">q_id_factor</span> <span class="hl std">=</span>  <span class="hl kwd">recode_factor</span><span class="hl std">(</span><span class="hl kwd">as.factor</span><span class="hl std">(q_id),</span>
                                                                        <span class="hl str">&quot;0&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;1&quot;</span><span class="hl std">,</span>
                                                                        <span class="hl str">&quot;5&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;6&quot;</span><span class="hl std">,</span>
                                                                        <span class="hl str">&quot;7&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;8&quot;</span><span class="hl std">,</span>
                                                                        <span class="hl str">&quot;8&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;9&quot;</span><span class="hl std">,</span>
                                                                        <span class="hl str">&quot;9&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;10&quot;</span><span class="hl std">,</span>
                                                                        <span class="hl str">&quot;10&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;12 (Apartment 6)&quot;</span><span class="hl std">,</span>
                                                                        <span class="hl str">&quot;11&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;13&quot;</span><span class="hl std">,</span>
                                                                        <span class="hl str">&quot;12&quot;</span> <span class="hl std">=</span> <span class="hl str">&quot;14 (Apartment 8)&quot;</span><span class="hl std">))</span>
<span class="hl com"># users' final prediction</span>
<span class="hl com"># breaks &lt;- seq(0,3,1)</span>
<span class="hl com"># prediction_dist_plot &lt;- ggplot(hist_responses, aes(x = final_pred, fill=condition)) +</span>
<span class="hl com">#   geom_histogram(binwidth = 0.1, alpha = 0.5) +</span>
<span class="hl com">#   geom_vline(alpha=.2, size=1, aes(xintercept = model_pred, linetype=&quot;Model's prediction&quot;))+</span>
<span class="hl com">#   geom_vline(alpha=.2, size=1, aes(xintercept = actual_price, linetype=&quot;Actual price&quot;))+</span>
<span class="hl com">#   scale_fill_manual(guide = FALSE,values=my_pallete) + scale_colour_manual(guide = FALSE, values=my_pallete)+</span>
<span class="hl com">#   facet_grid(vars(q_id_factor), vars(condition))+</span>
<span class="hl com">#   xlab(&quot;Participants' price prediction&quot;)+</span>
<span class="hl com">#   ylab(&quot;Number of participants&quot;)+</span>
<span class="hl com">#   scale_x_continuous(breaks = breaks, labels = sprintf('$%gM', breaks)) +</span>
<span class="hl com">#   theme(legend.position=&quot;top&quot;, legend.title = element_blank(), legend.key = element_rect(size = 10), legend.key.size = unit(1.5, 'lines'), legend.text=element_text(size=12),axis.title.x = element_text(size=20), axis.title.y = element_text(size=18), axis.text.x = element_text(angle = 45, size=10), axis.text.y = element_text(size=14), strip.text = element_text(size=8))</span>
<span class="hl com"># ggsave(prediction_dist_plot, filename = &quot;figures/exp4/dist_final_prediction.pdf&quot;, height=10, width=12)</span>


<span class="hl com">######################################################################</span>
<span class="hl com"># H1: effect of attention check (across both clear and bb conditions)</span>
<span class="hl com">######################################################################</span>

<span class="hl com"># effect size</span>
<span class="hl std">q6_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(responses , q_id</span> <span class="hl opt">==</span> <span class="hl str">&quot;10&quot;</span> <span class="hl opt">|</span> <span class="hl std">q_id</span> <span class="hl opt">==</span> <span class="hl str">&quot;12&quot;</span><span class="hl std">)</span>
<span class="hl std">focus_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(q6_data, condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;CLEAR-FOCUS&quot;</span> <span class="hl opt">|</span> <span class="hl std">condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;BB-FOCUS&quot;</span><span class="hl std">)</span>
<span class="hl std">no_focus_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(q6_data, condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;CLEAR-NO-FOCUS&quot;</span> <span class="hl opt">|</span> <span class="hl std">condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;BB-NO-FOCUS&quot;</span><span class="hl std">)</span>
<span class="hl std">effect_size</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">cohensD</span><span class="hl std">(focus_data</span><span class="hl opt">$</span><span class="hl std">signed_dev, no_focus_data</span><span class="hl opt">$</span><span class="hl std">signed_dev)</span>

<span class="hl std">q8_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(responses , q_id</span> <span class="hl opt">==</span> <span class="hl str">&quot;12&quot;</span> <span class="hl opt">|</span> <span class="hl std">q_id</span> <span class="hl opt">==</span> <span class="hl str">&quot;12&quot;</span><span class="hl std">)</span>
<span class="hl std">focus_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(q8_data, condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;CLEAR-FOCUS&quot;</span> <span class="hl opt">|</span> <span class="hl std">condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;BB-FOCUS&quot;</span><span class="hl std">)</span>
<span class="hl std">no_focus_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(q8_data, condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;CLEAR-NO-FOCUS&quot;</span> <span class="hl opt">|</span> <span class="hl std">condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;BB-NO-FOCUS&quot;</span><span class="hl std">)</span>
<span class="hl std">effect_size</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">cohensD</span><span class="hl std">(focus_data</span><span class="hl opt">$</span><span class="hl std">signed_dev, no_focus_data</span><span class="hl opt">$</span><span class="hl std">signed_dev)</span>

<span class="hl std">responses</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">filter</span><span class="hl std">(q_id</span> <span class="hl opt">%in%</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">10</span><span class="hl std">,</span> <span class="hl num">12</span><span class="hl std">))</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">group_by</span><span class="hl std">(q_id)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">do</span><span class="hl std">(</span><span class="hl kwd">tidy</span><span class="hl std">(</span><span class="hl kwd">t.test</span><span class="hl std">(signed_dev</span> <span class="hl opt">~</span> <span class="hl std">attention,</span> <span class="hl kwc">data</span> <span class="hl std">= .)))</span>
</pre></div>
<div class="output"><pre class="knitr r">## # A tibble: 2 x 11
## # Groups:   q_id [2]
##    q_id estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high method
##   &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1    10   -0.106    -0.233    -0.127     -4.72 2.73e-6      791.   -0.149   -0.0617 Welch…
## 2    12   -0.107    -0.233    -0.126     -5.00 7.12e-7      795.   -0.149   -0.0650 Welch…
## # … with 1 more variable: alternative &lt;chr&gt;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">responses</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">filter</span><span class="hl std">(q_id</span> <span class="hl opt">==</span> <span class="hl num">11</span><span class="hl std">)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">group_by</span><span class="hl std">(q_id)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">do</span><span class="hl std">(</span><span class="hl kwd">tidy</span><span class="hl std">(</span><span class="hl kwd">t.test</span><span class="hl std">(signed_dev</span> <span class="hl opt">~</span> <span class="hl std">attention,</span> <span class="hl kwc">data</span> <span class="hl std">= .)))</span>
</pre></div>
<div class="output"><pre class="knitr r">## # A tibble: 1 x 11
## # Groups:   q_id [1]
##    q_id estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high method
##   &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1    11   0.0127    0.0127 -1.46e-18      1.09   0.278      794.  -0.0102    0.0355 Welch…
## # … with 1 more variable: alternative &lt;chr&gt;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">######################################################################</span>
<span class="hl com"># H3: effect of transparency in conditions without attention check</span>
<span class="hl com">######################################################################</span>
<span class="hl std">q6_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(responses , q_id</span> <span class="hl opt">==</span> <span class="hl str">&quot;10&quot;</span><span class="hl std">)</span>
<span class="hl std">clear_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(q6_data, condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;CLEAR-NO-FOCUS&quot;</span><span class="hl std">)</span>
<span class="hl std">bb_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(q6_data, condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;BB-NO-FOCUS&quot;</span><span class="hl std">)</span>
<span class="hl std">effect_size</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">cohensD</span><span class="hl std">(clear_data</span><span class="hl opt">$</span><span class="hl std">signed_dev, bb_data</span><span class="hl opt">$</span><span class="hl std">signed_dev)</span>

<span class="hl std">q8_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(responses ,  q_id</span> <span class="hl opt">==</span> <span class="hl str">&quot;12&quot;</span><span class="hl std">)</span>
<span class="hl std">clear_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(q8_data, condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;CLEAR-NO-FOCUS&quot;</span><span class="hl std">)</span>
<span class="hl std">bb_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(q8_data, condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;BB-NO-FOCUS&quot;</span><span class="hl std">)</span>
<span class="hl std">effect_size</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">cohensD</span><span class="hl std">(clear_data</span><span class="hl opt">$</span><span class="hl std">signed_dev, bb_data</span><span class="hl opt">$</span><span class="hl std">signed_dev)</span>


<span class="hl std">responses</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">filter</span><span class="hl std">(q_id</span> <span class="hl opt">%in%</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">10</span><span class="hl std">,</span> <span class="hl num">12</span><span class="hl std">), attention</span> <span class="hl opt">==</span> <span class="hl str">&quot;NO-FOCUS&quot;</span><span class="hl std">)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">group_by</span><span class="hl std">(q_id)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">do</span><span class="hl std">(</span><span class="hl kwd">tidy</span><span class="hl std">(</span><span class="hl kwd">t.test</span><span class="hl std">(signed_dev</span> <span class="hl opt">~</span> <span class="hl std">transparency,</span> <span class="hl kwc">data</span> <span class="hl std">= .)))</span>
</pre></div>
<div class="output"><pre class="knitr r">## # A tibble: 2 x 11
## # Groups:   q_id [2]
##    q_id estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high method
##   &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1    10   -0.108    -0.180   -0.0723     -3.65 2.97e-4      393.   -0.166   -0.0498 Welch…
## 2    12   -0.101    -0.176   -0.0749     -3.51 5.00e-4      395.   -0.158   -0.0446 Welch…
## # … with 1 more variable: alternative &lt;chr&gt;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">responses</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">filter</span><span class="hl std">(q_id</span> <span class="hl opt">==</span> <span class="hl num">11</span><span class="hl std">, attention</span> <span class="hl opt">==</span> <span class="hl str">&quot;NO-FOCUS&quot;</span><span class="hl std">)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">group_by</span><span class="hl std">(q_id)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">do</span><span class="hl std">(</span><span class="hl kwd">tidy</span><span class="hl std">(</span><span class="hl kwd">t.test</span><span class="hl std">(signed_dev</span> <span class="hl opt">~</span> <span class="hl std">transparency,</span> <span class="hl kwc">data</span> <span class="hl std">= .)))</span>
</pre></div>
<div class="output"><pre class="knitr r">## # A tibble: 1 x 11
## # Groups:   q_id [1]
##    q_id estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high method
##   &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1    11  -0.0312   -0.0153    0.0159     -1.84  0.0672      369.  -0.0647   0.00223 Welch…
## # … with 1 more variable: alternative &lt;chr&gt;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">######################################################################</span>
<span class="hl com"># H3: effect of transparency in conditions with attention check</span>
<span class="hl com">######################################################################</span>
<span class="hl std">q6_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(responses , q_id</span> <span class="hl opt">==</span> <span class="hl str">&quot;10&quot;</span><span class="hl std">)</span>
<span class="hl std">clear_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(q6_data, condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;CLEAR-FOCUS&quot;</span><span class="hl std">)</span>
<span class="hl std">bb_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(q6_data, condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;BB-FOCUS&quot;</span><span class="hl std">)</span>
<span class="hl std">effect_size</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">cohensD</span><span class="hl std">(clear_data</span><span class="hl opt">$</span><span class="hl std">signed_dev, bb_data</span><span class="hl opt">$</span><span class="hl std">signed_dev)</span>

<span class="hl std">q8_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(responses ,  q_id</span> <span class="hl opt">==</span> <span class="hl str">&quot;12&quot;</span><span class="hl std">)</span>
<span class="hl std">clear_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(q8_data, condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;CLEAR-FOCUS&quot;</span><span class="hl std">)</span>
<span class="hl std">bb_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(q8_data, condition</span> <span class="hl opt">==</span> <span class="hl str">&quot;BB-FOCUS&quot;</span><span class="hl std">)</span>
<span class="hl std">effect_size</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">cohensD</span><span class="hl std">(clear_data</span><span class="hl opt">$</span><span class="hl std">signed_dev, bb_data</span><span class="hl opt">$</span><span class="hl std">signed_dev)</span>

<span class="hl std">responses</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">filter</span><span class="hl std">(q_id</span> <span class="hl opt">%in%</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">10</span><span class="hl std">,</span> <span class="hl num">12</span><span class="hl std">), attention</span> <span class="hl opt">==</span> <span class="hl str">&quot;FOCUS&quot;</span><span class="hl std">)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">group_by</span><span class="hl std">(q_id)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">do</span><span class="hl std">(</span><span class="hl kwd">tidy</span><span class="hl std">(</span><span class="hl kwd">t.test</span><span class="hl std">(signed_dev</span> <span class="hl opt">~</span> <span class="hl std">transparency,</span> <span class="hl kwc">data</span> <span class="hl std">= .)))</span>
</pre></div>
<div class="output"><pre class="knitr r">## # A tibble: 2 x 11
## # Groups:   q_id [2]
##    q_id estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high method
##   &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1    10 -1.63e-4    -0.233    -0.233  -0.00490   0.996      401.  -0.0654    0.0650 Welch…
## 2    12 -5.13e-2    -0.259    -0.208  -1.64      0.101      394.  -0.113     0.0100 Welch…
## # … with 1 more variable: alternative &lt;chr&gt;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">responses</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">filter</span><span class="hl std">(q_id</span> <span class="hl opt">==</span> <span class="hl num">11</span><span class="hl std">, attention</span> <span class="hl opt">==</span> <span class="hl str">&quot;FOCUS&quot;</span><span class="hl std">)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">group_by</span><span class="hl std">(q_id)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">do</span><span class="hl std">(</span><span class="hl kwd">tidy</span><span class="hl std">(</span><span class="hl kwd">t.test</span><span class="hl std">(signed_dev</span> <span class="hl opt">~</span> <span class="hl std">transparency,</span> <span class="hl kwc">data</span> <span class="hl std">= .)))</span>
</pre></div>
<div class="output"><pre class="knitr r">## # A tibble: 1 x 11
## # Groups:   q_id [1]
##    q_id estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high method
##   &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1    11 -0.00341    0.0109    0.0144    -0.214   0.831      348.  -0.0347    0.0279 Welch…
## # … with 1 more variable: alternative &lt;chr&gt;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># plot q8</span>
<span class="hl std">q8_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(responses,q_id</span> <span class="hl opt">==</span> <span class="hl num">12</span><span class="hl std">)</span>
<span class="hl std">q8_lm_model</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">lm</span><span class="hl std">(final_pred</span> <span class="hl opt">~</span> <span class="hl std">condition ,</span> <span class="hl kwc">data</span> <span class="hl std">= q8_data)</span>
<span class="hl kwd">summary</span><span class="hl std">(q8_lm_model)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = final_pred ~ condition, data = q8_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.82513 -0.22376 -0.02376  0.17487  1.37487 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           1.02513    0.02154  47.596  &lt; 2e-16 ***
## conditionBB-NO-FOCUS -0.10137    0.03019  -3.357 0.000825 ***
## conditionCLEAR-FOCUS -0.13305    0.03019  -4.406 1.20e-05 ***
## conditionBB-FOCUS    -0.18433    0.03023  -6.097 1.68e-09 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.3008 on 796 degrees of freedom
## Multiple R-squared:  0.04732,	Adjusted R-squared:  0.04373 
## F-statistic: 13.18 on 3 and 796 DF,  p-value: 2.101e-08
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">plot_data</span> <span class="hl kwb">&lt;-</span> <span class="hl std">q8_data</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">mutate</span><span class="hl std">(</span><span class="hl kwc">final_pred</span> <span class="hl std">= final_pred</span> <span class="hl opt">*</span> <span class="hl num">1e6</span><span class="hl std">)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">group_by</span><span class="hl std">(condition)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">summarize</span><span class="hl std">(</span><span class="hl kwc">mean</span> <span class="hl std">=</span> <span class="hl kwd">mean</span><span class="hl std">(</span><span class="hl kwd">abs</span><span class="hl std">(final_pred)),</span>
            <span class="hl kwc">se</span> <span class="hl std">=</span> <span class="hl kwd">sd</span><span class="hl std">(</span><span class="hl kwd">abs</span><span class="hl std">(final_pred))</span> <span class="hl opt">/</span> <span class="hl kwd">sqrt</span><span class="hl std">(</span><span class="hl kwd">n</span><span class="hl std">()),</span>
            <span class="hl kwc">model_pred</span> <span class="hl std">=</span> <span class="hl kwd">mean</span><span class="hl std">(model_pred</span> <span class="hl opt">*</span> <span class="hl num">1e6</span><span class="hl std">),</span>
            <span class="hl kwc">facet</span> <span class="hl std">=</span> <span class="hl str">'Apartment 8: 1 bed, 3 bath, 350 sq ft'</span><span class="hl std">)</span>
<span class="hl kwd">print</span><span class="hl std">(plot_data</span><span class="hl opt">$</span><span class="hl std">mean)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 1025128.2  923762.4  892079.2  840796.0
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">breaks</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">seq</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl num">1.5e6</span><span class="hl std">,</span> <span class="hl kwc">by</span> <span class="hl std">=</span> <span class="hl num">500e3</span><span class="hl std">)</span>
<span class="hl std">q8_final_pred_plot</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ggplot</span><span class="hl std">(plot_data,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= condition,</span> <span class="hl kwc">y</span> <span class="hl std">= mean,</span> <span class="hl kwc">color</span> <span class="hl std">= condition,</span> <span class="hl kwc">fill</span> <span class="hl std">= condition,</span> <span class="hl kwc">label</span><span class="hl std">=</span><span class="hl kwd">sprintf</span><span class="hl std">(</span><span class="hl str">&quot;$%gM&quot;</span><span class="hl std">,</span> <span class="hl kwd">round</span><span class="hl std">(mean</span><span class="hl opt">/</span><span class="hl num">1e6</span><span class="hl std">,</span> <span class="hl kwc">digits</span><span class="hl std">=</span><span class="hl num">2</span><span class="hl std">))))</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_bar</span><span class="hl std">(</span><span class="hl kwc">stat</span> <span class="hl std">=</span> <span class="hl str">&quot;identity&quot;</span><span class="hl std">,</span> <span class="hl kwc">alpha</span><span class="hl std">=</span><span class="hl num">.5</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_errorbar</span><span class="hl std">(</span><span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">ymin</span> <span class="hl std">= mean</span> <span class="hl opt">-</span> <span class="hl std">se,</span> <span class="hl kwc">ymax</span> <span class="hl std">= mean</span> <span class="hl opt">+</span> <span class="hl std">se),</span> <span class="hl kwc">width</span> <span class="hl std">=</span> <span class="hl num">0.1</span><span class="hl std">,</span> <span class="hl kwc">color</span> <span class="hl std">=</span> <span class="hl str">&quot;black&quot;</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_hline</span><span class="hl std">(</span><span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">yintercept</span> <span class="hl std">= model_pred,</span> <span class="hl kwc">linetype</span> <span class="hl std">=</span> <span class="hl str">&quot;Model's prediction&quot;</span><span class="hl std">),</span> <span class="hl kwc">alpha</span> <span class="hl std">=</span> <span class="hl num">0.5</span><span class="hl std">,</span> <span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">2</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">scale_fill_manual</span><span class="hl std">(</span><span class="hl kwc">guide</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span><span class="hl kwc">values</span><span class="hl std">=my_pallete)</span> <span class="hl opt">+</span> <span class="hl kwd">scale_colour_manual</span><span class="hl std">(</span><span class="hl kwc">guide</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span> <span class="hl kwc">values</span><span class="hl std">=my_pallete)</span><span class="hl opt">+</span>
  <span class="hl kwd">xlab</span><span class="hl std">(</span><span class="hl str">''</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">ylab</span><span class="hl std">(</span><span class="hl str">'Mean participant prediction'</span><span class="hl std">)</span><span class="hl opt">+</span>
  <span class="hl kwd">geom_text</span><span class="hl std">(</span><span class="hl kwc">colour</span><span class="hl std">=</span><span class="hl str">'black'</span><span class="hl std">,</span> <span class="hl kwc">vjust</span><span class="hl std">=</span><span class="hl opt">-</span><span class="hl num">1.5</span><span class="hl std">)</span><span class="hl opt">+</span>
  <span class="hl kwd">scale_y_continuous</span><span class="hl std">(</span><span class="hl kwc">breaks</span> <span class="hl std">= breaks,</span> <span class="hl kwc">limits</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl num">1.5e6</span><span class="hl std">),</span> <span class="hl kwc">labels</span> <span class="hl std">=</span> <span class="hl kwd">sprintf</span><span class="hl std">(</span><span class="hl str">'$%gM'</span><span class="hl std">, breaks</span><span class="hl opt">/</span><span class="hl num">1e6</span><span class="hl std">))</span> <span class="hl opt">+</span>
  <span class="hl kwd">scale_linetype_manual</span><span class="hl std">(</span><span class="hl kwc">values</span> <span class="hl std">=</span> <span class="hl str">&quot;dashed&quot;</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">theme</span><span class="hl std">(</span><span class="hl kwc">legend.position</span><span class="hl std">=</span><span class="hl str">&quot;bottom&quot;</span><span class="hl std">,</span><span class="hl kwc">axis.title.x</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">14</span><span class="hl std">),</span> <span class="hl kwc">axis.title.y</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">18</span><span class="hl std">),</span>
        <span class="hl kwc">axis.text.x</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">9</span><span class="hl std">),</span> <span class="hl kwc">axis.text.y</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">14</span><span class="hl std">),</span>
        <span class="hl kwc">legend.text</span><span class="hl std">=</span><span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">9</span><span class="hl std">),</span> <span class="hl kwc">legend.title</span> <span class="hl std">=</span> <span class="hl kwd">element_blank</span><span class="hl std">(),</span> <span class="hl kwc">legend.spacing.x</span><span class="hl std">=</span><span class="hl kwd">unit</span><span class="hl std">(</span><span class="hl num">0.5</span><span class="hl std">,</span><span class="hl str">&quot;line&quot;</span><span class="hl std">),</span> <span class="hl kwc">legend.margin</span><span class="hl std">=</span><span class="hl kwd">margin</span><span class="hl std">(</span><span class="hl kwc">t</span><span class="hl std">=</span><span class="hl opt">-</span><span class="hl num">.5</span><span class="hl std">,</span> <span class="hl kwc">r</span><span class="hl std">=</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl kwc">b</span><span class="hl std">=</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl kwc">l</span><span class="hl std">=</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl kwc">unit</span><span class="hl std">=</span><span class="hl str">&quot;cm&quot;</span><span class="hl std">),</span>
        <span class="hl kwc">strip.text</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">9</span><span class="hl std">))</span><span class="hl opt">+</span>
  <span class="hl kwd">facet_wrap</span><span class="hl std">(</span><span class="hl opt">~</span> <span class="hl std">facet)</span>
<span class="hl kwd">ggsave</span><span class="hl std">(q8_final_pred_plot,</span> <span class="hl kwc">filename</span> <span class="hl std">=</span> <span class="hl str">&quot;figures/exp4/q8_pred.pdf&quot;</span><span class="hl std">,</span> <span class="hl kwc">height</span><span class="hl std">=</span><span class="hl num">4</span><span class="hl std">,</span> <span class="hl kwc">width</span><span class="hl std">=</span><span class="hl num">6</span><span class="hl std">)</span>

<span class="hl com"># plot for q6</span>
<span class="hl std">q6_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(responses,q_id</span> <span class="hl opt">==</span> <span class="hl num">10</span><span class="hl std">)</span>
<span class="hl std">q6_lm_model</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">lm</span><span class="hl std">(final_pred</span> <span class="hl opt">~</span> <span class="hl std">condition ,</span> <span class="hl kwc">data</span> <span class="hl std">= q6_data)</span>
<span class="hl kwd">summary</span><span class="hl std">(q6_lm_model)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = final_pred ~ condition, data = q6_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0198 -0.2218 -0.0198  0.1802  1.0723 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           1.42769    0.02251  63.429  &lt; 2e-16 ***
## conditionBB-NO-FOCUS -0.10789    0.03155  -3.419  0.00066 ***
## conditionCLEAR-FOCUS -0.16037    0.03155  -5.082 4.65e-07 ***
## conditionBB-FOCUS    -0.16053    0.03159  -5.081 4.68e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.3143 on 796 degrees of freedom
## Multiple R-squared:  0.04125,	Adjusted R-squared:  0.03763 
## F-statistic: 11.41 on 3 and 796 DF,  p-value: 2.468e-07
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">plot_data</span> <span class="hl kwb">&lt;-</span> <span class="hl std">q6_data</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">mutate</span><span class="hl std">(</span><span class="hl kwc">final_pred</span> <span class="hl std">= final_pred</span> <span class="hl opt">*</span> <span class="hl num">1e6</span><span class="hl std">)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">group_by</span><span class="hl std">(condition)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">summarize</span><span class="hl std">(</span><span class="hl kwc">mean</span> <span class="hl std">=</span> <span class="hl kwd">mean</span><span class="hl std">(</span><span class="hl kwd">abs</span><span class="hl std">(final_pred)),</span>
            <span class="hl kwc">se</span> <span class="hl std">=</span> <span class="hl kwd">sd</span><span class="hl std">(</span><span class="hl kwd">abs</span><span class="hl std">(final_pred))</span> <span class="hl opt">/</span> <span class="hl kwd">sqrt</span><span class="hl std">(</span><span class="hl kwd">n</span><span class="hl std">()),</span>
            <span class="hl kwc">model_pred</span> <span class="hl std">=</span> <span class="hl kwd">mean</span><span class="hl std">(model_pred</span> <span class="hl opt">*</span> <span class="hl num">1e6</span><span class="hl std">),</span>
            <span class="hl kwc">facet</span> <span class="hl std">=</span> <span class="hl str">'Apartment 6: 1 bed, 3 bath, 726 sq ft'</span><span class="hl std">)</span>
<span class="hl kwd">print</span><span class="hl std">(plot_data</span><span class="hl opt">$</span><span class="hl std">mean)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 1427692 1319802 1267327 1267164
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">breaks</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">seq</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl num">1.5e6</span><span class="hl std">,</span> <span class="hl kwc">by</span> <span class="hl std">=</span> <span class="hl num">500e3</span><span class="hl std">)</span>
<span class="hl std">q6_final_pred_plot</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ggplot</span><span class="hl std">(plot_data,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= condition,</span> <span class="hl kwc">y</span> <span class="hl std">= mean,</span> <span class="hl kwc">color</span> <span class="hl std">= condition,</span> <span class="hl kwc">fill</span> <span class="hl std">= condition,</span> <span class="hl kwc">label</span><span class="hl std">=</span><span class="hl kwd">sprintf</span><span class="hl std">(</span><span class="hl str">&quot;$%gM&quot;</span><span class="hl std">,</span> <span class="hl kwd">round</span><span class="hl std">(mean</span><span class="hl opt">/</span><span class="hl num">1e6</span><span class="hl std">,</span> <span class="hl kwc">digits</span><span class="hl std">=</span><span class="hl num">2</span><span class="hl std">))))</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_bar</span><span class="hl std">(</span><span class="hl kwc">stat</span> <span class="hl std">=</span> <span class="hl str">&quot;identity&quot;</span><span class="hl std">,</span> <span class="hl kwc">alpha</span><span class="hl std">=</span><span class="hl num">.5</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_errorbar</span><span class="hl std">(</span><span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">ymin</span> <span class="hl std">= mean</span> <span class="hl opt">-</span> <span class="hl std">se,</span> <span class="hl kwc">ymax</span> <span class="hl std">= mean</span> <span class="hl opt">+</span> <span class="hl std">se),</span> <span class="hl kwc">width</span> <span class="hl std">=</span> <span class="hl num">0.1</span><span class="hl std">,</span> <span class="hl kwc">color</span> <span class="hl std">=</span> <span class="hl str">&quot;black&quot;</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_hline</span><span class="hl std">(</span><span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">yintercept</span> <span class="hl std">= model_pred,</span> <span class="hl kwc">linetype</span> <span class="hl std">=</span> <span class="hl str">&quot;Model's prediction&quot;</span><span class="hl std">),</span> <span class="hl kwc">alpha</span> <span class="hl std">=</span> <span class="hl num">0.5</span><span class="hl std">,</span> <span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">2</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">scale_fill_manual</span><span class="hl std">(</span><span class="hl kwc">guide</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span><span class="hl kwc">values</span><span class="hl std">=my_pallete)</span> <span class="hl opt">+</span> <span class="hl kwd">scale_colour_manual</span><span class="hl std">(</span><span class="hl kwc">guide</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span> <span class="hl kwc">values</span><span class="hl std">=my_pallete)</span><span class="hl opt">+</span>
  <span class="hl kwd">xlab</span><span class="hl std">(</span><span class="hl str">''</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">ylab</span><span class="hl std">(</span><span class="hl str">'Mean participant prediction'</span><span class="hl std">)</span><span class="hl opt">+</span>
  <span class="hl kwd">geom_text</span><span class="hl std">(</span><span class="hl kwc">colour</span><span class="hl std">=</span><span class="hl str">'black'</span><span class="hl std">,</span> <span class="hl kwc">vjust</span><span class="hl std">=</span><span class="hl opt">-</span><span class="hl num">1.5</span><span class="hl std">)</span><span class="hl opt">+</span>
  <span class="hl kwd">scale_y_continuous</span><span class="hl std">(</span><span class="hl kwc">breaks</span> <span class="hl std">= breaks,</span> <span class="hl kwc">limits</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl num">1.5e6</span><span class="hl std">),</span> <span class="hl kwc">labels</span> <span class="hl std">=</span> <span class="hl kwd">sprintf</span><span class="hl std">(</span><span class="hl str">'$%gM'</span><span class="hl std">, breaks</span><span class="hl opt">/</span><span class="hl num">1e6</span><span class="hl std">))</span> <span class="hl opt">+</span>
  <span class="hl kwd">scale_linetype_manual</span><span class="hl std">(</span><span class="hl kwc">values</span> <span class="hl std">=</span> <span class="hl str">&quot;dashed&quot;</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">theme</span><span class="hl std">(</span><span class="hl kwc">legend.position</span><span class="hl std">=</span><span class="hl str">&quot;bottom&quot;</span><span class="hl std">,</span><span class="hl kwc">axis.title.x</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">14</span><span class="hl std">),</span> <span class="hl kwc">axis.title.y</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">18</span><span class="hl std">),</span>
        <span class="hl kwc">axis.text.x</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">9</span><span class="hl std">),</span> <span class="hl kwc">axis.text.y</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">14</span><span class="hl std">),</span>
        <span class="hl kwc">legend.text</span><span class="hl std">=</span><span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">9</span><span class="hl std">),</span> <span class="hl kwc">legend.title</span> <span class="hl std">=</span> <span class="hl kwd">element_blank</span><span class="hl std">(),</span> <span class="hl kwc">legend.spacing.x</span><span class="hl std">=</span><span class="hl kwd">unit</span><span class="hl std">(</span><span class="hl num">0.5</span><span class="hl std">,</span><span class="hl str">&quot;line&quot;</span><span class="hl std">),</span> <span class="hl kwc">legend.margin</span><span class="hl std">=</span><span class="hl kwd">margin</span><span class="hl std">(</span><span class="hl kwc">t</span><span class="hl std">=</span><span class="hl opt">-</span><span class="hl num">.5</span><span class="hl std">,</span> <span class="hl kwc">r</span><span class="hl std">=</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl kwc">b</span><span class="hl std">=</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl kwc">l</span><span class="hl std">=</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl kwc">unit</span><span class="hl std">=</span><span class="hl str">&quot;cm&quot;</span><span class="hl std">),</span>
        <span class="hl kwc">strip.text</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">9</span><span class="hl std">))</span><span class="hl opt">+</span>
  <span class="hl kwd">facet_wrap</span><span class="hl std">(</span><span class="hl opt">~</span> <span class="hl std">facet)</span>
<span class="hl kwd">ggsave</span><span class="hl std">(q6_final_pred_plot,</span> <span class="hl kwc">filename</span> <span class="hl std">=</span> <span class="hl str">&quot;figures/exp4/q6_pred.pdf&quot;</span><span class="hl std">,</span> <span class="hl kwc">height</span><span class="hl std">=</span><span class="hl num">4</span><span class="hl std">,</span> <span class="hl kwc">width</span><span class="hl std">=</span><span class="hl num">6</span><span class="hl std">)</span>

<span class="hl com"># plot for q7</span>
<span class="hl std">q7_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">filter</span><span class="hl std">(responses,q_id</span> <span class="hl opt">==</span> <span class="hl num">11</span><span class="hl std">)</span>
<span class="hl std">q7_lm_model</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">lm</span><span class="hl std">(final_pred</span> <span class="hl opt">~</span> <span class="hl std">condition ,</span> <span class="hl kwc">data</span> <span class="hl std">= q7_data)</span>
<span class="hl kwd">summary</span><span class="hl std">(q6_lm_model)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = final_pred ~ condition, data = q6_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0198 -0.2218 -0.0198  0.1802  1.0723 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           1.42769    0.02251  63.429  &lt; 2e-16 ***
## conditionBB-NO-FOCUS -0.10789    0.03155  -3.419  0.00066 ***
## conditionCLEAR-FOCUS -0.16037    0.03155  -5.082 4.65e-07 ***
## conditionBB-FOCUS    -0.16053    0.03159  -5.081 4.68e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.3143 on 796 degrees of freedom
## Multiple R-squared:  0.04125,	Adjusted R-squared:  0.03763 
## F-statistic: 11.41 on 3 and 796 DF,  p-value: 2.468e-07
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">plot_data</span> <span class="hl kwb">&lt;-</span> <span class="hl std">q7_data</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">mutate</span><span class="hl std">(</span><span class="hl kwc">final_pred</span> <span class="hl std">= final_pred</span> <span class="hl opt">*</span> <span class="hl num">1e6</span><span class="hl std">)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">group_by</span><span class="hl std">(condition)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">summarize</span><span class="hl std">(</span><span class="hl kwc">mean</span> <span class="hl std">=</span> <span class="hl kwd">mean</span><span class="hl std">(</span><span class="hl kwd">abs</span><span class="hl std">(final_pred)),</span>
            <span class="hl kwc">se</span> <span class="hl std">=</span> <span class="hl kwd">sd</span><span class="hl std">(</span><span class="hl kwd">abs</span><span class="hl std">(final_pred))</span> <span class="hl opt">/</span> <span class="hl kwd">sqrt</span><span class="hl std">(</span><span class="hl kwd">n</span><span class="hl std">()),</span>
            <span class="hl kwc">model_pred</span> <span class="hl std">=</span> <span class="hl kwd">mean</span><span class="hl std">(model_pred</span> <span class="hl opt">*</span> <span class="hl num">1e6</span><span class="hl std">),</span>
            <span class="hl kwc">facet</span> <span class="hl std">=</span> <span class="hl str">'Apartment 7: 1 bed, 1 bath, 788 sq ft'</span><span class="hl std">)</span>
<span class="hl kwd">print</span><span class="hl std">(plot_data</span><span class="hl opt">$</span><span class="hl std">mean)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 915897.4 884653.5 914356.4 910945.3
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">breaks</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">seq</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl num">1.5e6</span><span class="hl std">,</span> <span class="hl kwc">by</span> <span class="hl std">=</span> <span class="hl num">500e3</span><span class="hl std">)</span>
<span class="hl std">q7_final_pred_plot</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ggplot</span><span class="hl std">(plot_data,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= condition,</span> <span class="hl kwc">y</span> <span class="hl std">= mean,</span> <span class="hl kwc">color</span> <span class="hl std">= condition,</span> <span class="hl kwc">fill</span> <span class="hl std">= condition,</span> <span class="hl kwc">label</span><span class="hl std">=</span><span class="hl kwd">sprintf</span><span class="hl std">(</span><span class="hl str">&quot;$%gM&quot;</span><span class="hl std">,</span> <span class="hl kwd">round</span><span class="hl std">(mean</span><span class="hl opt">/</span><span class="hl num">1e6</span><span class="hl std">,</span> <span class="hl kwc">digits</span><span class="hl std">=</span><span class="hl num">2</span><span class="hl std">))))</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_bar</span><span class="hl std">(</span><span class="hl kwc">stat</span> <span class="hl std">=</span> <span class="hl str">&quot;identity&quot;</span><span class="hl std">,</span> <span class="hl kwc">alpha</span><span class="hl std">=</span><span class="hl num">.5</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_errorbar</span><span class="hl std">(</span><span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">ymin</span> <span class="hl std">= mean</span> <span class="hl opt">-</span> <span class="hl std">se,</span> <span class="hl kwc">ymax</span> <span class="hl std">= mean</span> <span class="hl opt">+</span> <span class="hl std">se),</span> <span class="hl kwc">width</span> <span class="hl std">=</span> <span class="hl num">0.1</span><span class="hl std">,</span> <span class="hl kwc">color</span> <span class="hl std">=</span> <span class="hl str">&quot;black&quot;</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_hline</span><span class="hl std">(</span><span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">yintercept</span> <span class="hl std">= model_pred,</span> <span class="hl kwc">linetype</span> <span class="hl std">=</span> <span class="hl str">&quot;Model's prediction&quot;</span><span class="hl std">),</span> <span class="hl kwc">alpha</span> <span class="hl std">=</span> <span class="hl num">0.5</span><span class="hl std">,</span> <span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">2</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">scale_fill_manual</span><span class="hl std">(</span><span class="hl kwc">guide</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span><span class="hl kwc">values</span><span class="hl std">=my_pallete)</span> <span class="hl opt">+</span> <span class="hl kwd">scale_colour_manual</span><span class="hl std">(</span><span class="hl kwc">guide</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span> <span class="hl kwc">values</span><span class="hl std">=my_pallete)</span><span class="hl opt">+</span>
  <span class="hl kwd">xlab</span><span class="hl std">(</span><span class="hl str">''</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">ylab</span><span class="hl std">(</span><span class="hl str">'Mean participant prediction'</span><span class="hl std">)</span><span class="hl opt">+</span>
  <span class="hl kwd">geom_text</span><span class="hl std">(</span><span class="hl kwc">colour</span><span class="hl std">=</span><span class="hl str">'black'</span><span class="hl std">,</span> <span class="hl kwc">vjust</span><span class="hl std">=</span><span class="hl opt">-</span><span class="hl num">1.5</span><span class="hl std">)</span><span class="hl opt">+</span>
  <span class="hl kwd">scale_y_continuous</span><span class="hl std">(</span><span class="hl kwc">breaks</span> <span class="hl std">= breaks,</span> <span class="hl kwc">limits</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl num">1.5e6</span><span class="hl std">),</span> <span class="hl kwc">labels</span> <span class="hl std">=</span> <span class="hl kwd">sprintf</span><span class="hl std">(</span><span class="hl str">'$%gM'</span><span class="hl std">, breaks</span><span class="hl opt">/</span><span class="hl num">1e6</span><span class="hl std">))</span> <span class="hl opt">+</span>
  <span class="hl kwd">scale_linetype_manual</span><span class="hl std">(</span><span class="hl kwc">values</span> <span class="hl std">=</span> <span class="hl str">&quot;dashed&quot;</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">theme</span><span class="hl std">(</span><span class="hl kwc">legend.position</span><span class="hl std">=</span><span class="hl str">&quot;bottom&quot;</span><span class="hl std">,</span><span class="hl kwc">axis.title.x</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">14</span><span class="hl std">),</span> <span class="hl kwc">axis.title.y</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">18</span><span class="hl std">),</span>
        <span class="hl kwc">axis.text.x</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">9</span><span class="hl std">),</span> <span class="hl kwc">axis.text.y</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">14</span><span class="hl std">),</span>
        <span class="hl kwc">legend.text</span><span class="hl std">=</span><span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">9</span><span class="hl std">),</span> <span class="hl kwc">legend.title</span> <span class="hl std">=</span> <span class="hl kwd">element_blank</span><span class="hl std">(),</span> <span class="hl kwc">legend.spacing.x</span><span class="hl std">=</span><span class="hl kwd">unit</span><span class="hl std">(</span><span class="hl num">0.5</span><span class="hl std">,</span><span class="hl str">&quot;line&quot;</span><span class="hl std">),</span> <span class="hl kwc">legend.margin</span><span class="hl std">=</span><span class="hl kwd">margin</span><span class="hl std">(</span><span class="hl kwc">t</span><span class="hl std">=</span><span class="hl opt">-</span><span class="hl num">.5</span><span class="hl std">,</span> <span class="hl kwc">r</span><span class="hl std">=</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl kwc">b</span><span class="hl std">=</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl kwc">l</span><span class="hl std">=</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl kwc">unit</span><span class="hl std">=</span><span class="hl str">&quot;cm&quot;</span><span class="hl std">),</span>
        <span class="hl kwc">strip.text</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">9</span><span class="hl std">))</span><span class="hl opt">+</span>
  <span class="hl kwd">facet_wrap</span><span class="hl std">(</span><span class="hl opt">~</span> <span class="hl std">facet)</span>
<span class="hl kwd">ggsave</span><span class="hl std">(q7_final_pred_plot,</span> <span class="hl kwc">filename</span> <span class="hl std">=</span> <span class="hl str">&quot;figures/exp4/q7_pred.pdf&quot;</span><span class="hl std">,</span> <span class="hl kwc">height</span><span class="hl std">=</span><span class="hl num">4</span><span class="hl std">,</span> <span class="hl kwc">width</span><span class="hl std">=</span><span class="hl num">6</span><span class="hl std">)</span>
</pre></div>
</div></div>

  <p>The R session information (including the OS info, R version and all
    packages used):</p>

<div class="chunk" id="session-info"><div class="rcode"><div class="source"><pre class="knitr r">    <span class="hl kwd">sessionInfo</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## R version 3.5.1 (2018-07-02)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS  10.16
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] ggridges_0.5.1  lsr_0.5         xtable_1.8-2    broom_0.5.0     scales_0.5.0   
##  [6] forcats_0.3.0   stringr_1.3.1   dplyr_0.8.3     purrr_0.2.5     readr_1.1.1    
## [11] tidyr_0.8.1     tibble_2.1.3    ggplot2_3.0.0   tidyverse_1.2.1
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.3       cellranger_1.1.0 pillar_1.4.3     compiler_3.5.1   highr_0.7       
##  [6] plyr_1.8.4       tools_3.5.1      zeallot_0.1.0    digest_0.6.15    jsonlite_1.5    
## [11] lubridate_1.7.4  evaluate_0.11    nlme_3.1-137     gtable_0.2.0     lattice_0.20-35 
## [16] pkgconfig_2.0.1  rlang_0.4.2      cli_1.1.0        rstudioapi_0.7   haven_1.1.2     
## [21] withr_2.1.2      xml2_1.2.0       httr_1.3.1       knitr_1.20       vctrs_0.2.1     
## [26] hms_0.4.2        grid_3.5.1       tidyselect_0.2.5 glue_1.3.1       R6_2.2.2        
## [31] fansi_0.4.1      readxl_1.1.0     reshape2_1.4.3   modelr_0.1.2     magrittr_1.5    
## [36] backports_1.1.2  rvest_0.3.2      assertthat_0.2.0 colorspace_1.3-2 labeling_0.3    
## [41] utf8_1.1.4       stringi_1.2.3    lazyeval_0.2.1   munsell_0.5.0    crayon_1.3.4
</pre></div>
<div class="source"><pre class="knitr r">    <span class="hl kwd">Sys.time</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;2021-01-08 17:58:58 EST&quot;
</pre></div>
</div></div>


</body>
</html>
